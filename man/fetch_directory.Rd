% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fetch_directory.R
\name{fetch_directory}
\alias{fetch_directory}
\title{Fetch Tennessee school directory data}
\usage{
fetch_directory(end_year = NULL, tidy = TRUE, use_cache = TRUE)
}
\arguments{
\item{end_year}{Currently unused. The directory represents the current state
of Tennessee schools and is updated regularly by TDOE. Included for API
consistency with other fetch functions.}

\item{tidy}{If TRUE (default), returns data in a standardized format with
consistent column names. If FALSE, returns raw column names from the API.}

\item{use_cache}{If TRUE (default), uses locally cached data when available.
Set to FALSE to force re-download from TDOE.}
}
\value{
A tibble with school directory data. Columns include:
\itemize{
\item \code{entity_type}: "school" or "district"
\item \code{state_district_id}: District number (from sde_entitynameunique)
\item \code{state_school_id}: School number (accountnumber)
\item \code{district_name}: Name of the school district
\item \code{school_name}: Name of the school (NA for district rows)
\item \code{school_type}: Public, Private, or Charter
\item \code{instructional_type}: Regular, High School, etc.
\item \code{address}: Street address
\item \code{city}: City
\item \code{state}: State (always "TN")
\item \code{zip}: ZIP code
\item \code{phone}: Phone number
\item \code{county_name}: County name
\item \code{grades_served}: Comma-separated grade levels
\item \code{principal_name}: School principal name (from primary contact)
\item \code{principal_email}: School principal email
\item \code{superintendent_name}: District superintendent (from primary contact for districts)
\item \code{superintendent_email}: District superintendent email
\item \code{website}: School or district website URL
\item \code{status}: Active or Inactive
\item \code{nces_number}: NCES identification number
}
}
\description{
Downloads and processes school directory data from the Tennessee Department
of Education's School Directory portal (tnschooldirectory.tnedu.gov).
Returns a combined dataset of schools and districts with contact information,
addresses, grade levels, and administrator names.
}
\details{
The directory data is downloaded from the TN School Directory portal, which
is powered by Microsoft Dynamics 365. The API returns JSON data via FetchXML
queries. Schools and districts are fetched separately and combined.

The API paginates results in pages of up to 5000 records. For schools
(~3000 records) pagination is handled automatically.
}
\examples{
\dontrun{
# Get school directory data
dir_data <- fetch_directory()

# Get raw format (original API field names)
dir_raw <- fetch_directory(tidy = FALSE)

# Force fresh download (ignore cache)
dir_fresh <- fetch_directory(use_cache = FALSE)

# Filter to active public schools
library(dplyr)
public_schools <- dir_data |>
  filter(entity_type == "school", school_type == "Public", status == "Active")

# Find all schools in Davidson County (Nashville)
nashville <- dir_data |>
  filter(county_name == "Davidson", entity_type == "school")
}
}
